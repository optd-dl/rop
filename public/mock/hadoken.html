<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <style>
        /*
fork this demo on github:
https://github.com/jkneb/street-fighter-css
*/
        /*
        A little more explanations on how it works
        http://front-back.com/animate-png-sprites-with-css3-animations
        */
        /*
        All vendor prefixes are autogenerated by Autoprefixer
        */
        /* element who's going to receive this class will be mirrored */
        .flip {
            -webkit-transform: scaleX(-1);
            transform: scaleX(-1);
        }

        /* sprite tile dimensions */
        /* ken */
        .ken, .fireball {
            position: absolute;
            bottom: 112px;
            margin-left: 150px;
            width: 70px;
            height: 80px;
            background-image: url("http://front-back.com/wp-content/uploads/2013/01/ken.png");
            /* other sprites preloading */
        }
        .ken:before, .fireball:before {
            content: '';
            background: url("http://front-back.com/wp-content/uploads/2013/01/ken-tatsumaki-senpuu-kyaku.png") no-repeat;
        }
        .ken:after, .fireball:after {
            content: '';
            background: url("http://front-back.com/wp-content/uploads/2013/01/ken-shoryuken.png") no-repeat;
        }

        /* ken's fireball */
        .fireball {
            position: absolute;
            left: 100%;
            bottom: 0px;
            margin-left: 0;
            /* default margin-left */
            background-position: 140px 320px;
            /* default background position */
            -webkit-transition: margin 8s linear;
            transition: margin 8s linear;
            /* triggering the movement with this class */
            -webkit-animation: fireball steps(2) 0.15s infinite;
            animation: fireball steps(2) 0.15s infinite;
        }
        .fireball:before {
            left: 25px;
            right: 25px;
        }
        .fireball.moving {
            margin-left: 4000px;
        }

        @-webkit-keyframes fireball {
            from {
                background-position: 0px -320px;
            }
            to {
                background-position: -140px -320px;
            }
        }

        @keyframes fireball {
            from {
                background-position: 0px -320px;
            }
            to {
                background-position: -140px -320px;
            }
        }
        /* ken's fireball impact explosion */
        .explode {
            -webkit-animation: explode steps(4) 0.5s 1;
            animation: explode steps(4) 0.5s 1;
        }

        @-webkit-keyframes explode {
            from {
                background-position: 0px -400px;
            }
            to {
                background-position: -280px -400px;
            }
        }

        @keyframes explode {
            from {
                background-position: 0px -400px;
            }
            to {
                background-position: -280px -400px;
            }
        }
        /* stance */
        .stance {
            -webkit-animation: stance steps(4) 0.5s infinite;
            animation: stance steps(4) 0.5s infinite;
        }

        @-webkit-keyframes stance {
            from {
                background-position: 0px -80px;
            }
            to {
                background-position: -280px -80px;
            }
        }

        @keyframes stance {
            from {
                background-position: 0px -80px;
            }
            to {
                background-position: -280px -80px;
            }
        }
        /* hadoken - must be declared AFTER .stance */
        .hadoken {
            -webkit-animation: hadoken steps(4) 0.5s infinite;
            animation: hadoken steps(4) 0.5s infinite;
        }

        @-webkit-keyframes hadoken {
            from {
                background-position: 0px 0px;
            }
            to {
                background-position: -280px 0px;
            }
        }

        @keyframes hadoken {
            from {
                background-position: 0px 0px;
            }
            to {
                background-position: -280px 0px;
            }
        }
        /* punch */
        .punch {
            -webkit-animation: punch steps(3) 0.15s infinite;
            animation: punch steps(3) 0.15s infinite;
        }

        @-webkit-keyframes punch {
            from {
                background-position: 0px -160px;
            }
            to {
                background-position: -210px -160px;
            }
        }

        @keyframes punch {
            from {
                background-position: 0px -160px;
            }
            to {
                background-position: -210px -160px;
            }
        }
        /* walking */
        .walk {
            -webkit-animation: walk steps(5) 0.5s infinite;
            animation: walk steps(5) 0.5s infinite;
        }

        @-webkit-keyframes walk {
            from {
                background-position: 0px -240px;
            }
            to {
                background-position: -350px -240px;
            }
        }

        @keyframes walk {
            from {
                background-position: 0px -240px;
            }
            to {
                background-position: -350px -240px;
            }
        }
        /* kick */
        .kick {
            -webkit-animation: kick steps(5) 0.5s infinite;
            animation: kick steps(5) 0.5s infinite;
        }

        @-webkit-keyframes kick {
            from {
                background-position: 0px -480px;
            }
            to {
                background-position: -350px -480px;
            }
        }

        @keyframes kick {
            from {
                background-position: 0px -480px;
            }
            to {
                background-position: -350px -480px;
            }
        }
        /* reverse kick */
        .reversekick {
            -webkit-animation: reversekick steps(5) 0.5s infinite;
            animation: reversekick steps(5) 0.5s infinite;
        }

        @-webkit-keyframes reversekick {
            from {
                background-position: 0px -560px;
            }
            to {
                background-position: -350px -560px;
            }
        }

        @keyframes reversekick {
            from {
                background-position: 0px -560px;
            }
            to {
                background-position: -350px -560px;
            }
        }
        /* kneel down */
        .kneel {
            -webkit-animation: kneel steps(1) 0.2s infinite;
            animation: kneel steps(1) 0.2s infinite;
        }

        @-webkit-keyframes kneel {
            from {
                background-position: 0px -720px;
            }
            to {
                background-position: -70px -720px;
            }
        }

        @keyframes kneel {
            from {
                background-position: 0px -720px;
            }
            to {
                background-position: -70px -720px;
            }
        }
        /* jump */
        .jump {
            -webkit-transition: bottom 0.5s cubic-bezier(0.99, 0.005, 0, 0.42);
            transition: bottom 0.5s cubic-bezier(0.99, 0.005, 0, 0.42);
            bottom: 225px;
            -webkit-animation: jump steps(7) 1s infinite;
            animation: jump steps(7) 1s infinite;
        }
        .jump.down {
            bottom: 112px;
        }

        @-webkit-keyframes jump {
            from {
                background-position: 0px -640px;
            }
            to {
                background-position: -490px -640px;
            }
        }

        @keyframes jump {
            from {
                background-position: 0px -640px;
            }
            to {
                background-position: -490px -640px;
            }
        }
        /* shoryuken */
        .shoryuken {
            height: 110px;
            background-image: url("http://front-back.com/wp-content/uploads/2013/01/ken-shoryuken.png");
            -webkit-transition: bottom 0.5s cubic-bezier(0.99, 0.005, 0, 0.42);
            transition: bottom 0.5s cubic-bezier(0.99, 0.005, 0, 0.42);
            bottom: 225px;
            -webkit-animation: shoryuken steps(7) 1s infinite;
            animation: shoryuken steps(7) 1s infinite;
        }
        .shoryuken.down {
            bottom: 112px;
        }

        @-webkit-keyframes shoryuken {
            from {
                background-position: 0px 0px;
            }
            to {
                background-position: -490px 0px;
            }
        }

        @keyframes shoryuken {
            from {
                background-position: 0px 0px;
            }
            to {
                background-position: -490px 0px;
            }
        }
        /* tatsumaki senpuu kyaku */
        .tatsumaki {
            height: 110px;
            background-image: url("http://front-back.com/wp-content/uploads/2013/01/ken-tatsumaki-senpuu-kyaku.png");
            -webkit-transition: bottom 0.2s cubic-bezier(0.99, 0.005, 0, 0.42);
            transition: bottom 0.2s cubic-bezier(0.99, 0.005, 0, 0.42);
            bottom: 132px;
            -webkit-animation: tatsumaki steps(13) 2s infinite;
            animation: tatsumaki steps(13) 2s infinite;
        }
        .tatsumaki.down {
            bottom: 112px;
        }

        @-webkit-keyframes tatsumaki {
            from {
                background-position: 0px 0px;
            }
            to {
                background-position: -910px 0px;
            }
        }

        @keyframes tatsumaki {
            from {
                background-position: 0px 0px;
            }
            to {
                background-position: -910px 0px;
            }
        }
        .commands {
            margin-left: 450px;
            font-size: 12px;
            padding: 15px;
        }
        .commands h1 {
            margin-top: 0;
            font-size: 14px;
        }
        .commands i {
            padding: 0px 4px;
            font-style: normal;
            font-weight: bold;
            outline: 1px solid pink;
        }
        .commands button + button {
            white-space: nowrap;
        }

        .stage {
            position: absolute;
            top: 0;
            width: 450px;
            height: 330px;
            background: url("http://front-back.com/wp-content/uploads/2013/01/sf2-bg.jpg") no-repeat 0px -100px;
            background-size: contain;
            float: left;
            margin-right: 20px;
        }

        body {
            margin: 0px;
            padding: 0;
        }

    </style>
</head>
<body>
<div class="stage">
    <div class="ken stance"></div>
</div>





<div class="commands">
    <h1>Control Ken with ur keyboard</h1>

    Punch: <button id="a">a</button><br>
    Kick: <button id="z">z</button><br>
    Reverse kick: <button id="e">e</button><br>
    <br>
    Tatsumaki: <button id="q">q</button><br>
    Hadoken: <button id="s">s</button><br>
    Shoryuken: <button id="d">d</button><br>
    <br>
    Jump: &nbsp;&nbsp;&nbsp;<button id="up">▲</button><br>
    Walk: <button id="left">◀</button><button id="right">►</button><br>
    Kneel: &nbsp;&nbsp;<button id="down">▼</button>
</div>

</body>
<script src="/Users/robin/workspace/rop/node/public/vendor/jquery/dist/jquery.min.js">//</script>
<script>
    var $ken = $('.ken');
    var $kenPos, $fireballPos;

    var punch = function(){
        $ken.addClass('punch');
        setTimeout(function() { $ken.removeClass('punch'); }, 150);
    };
    var kick = function(){
        $ken.addClass('kick');
        setTimeout(function() { $ken.removeClass('kick'); }, 500);
    };
    var rkick = function(){
        $ken.addClass('reversekick');
        setTimeout(function() { $ken.removeClass('reversekick'); }, 500);
    };
    var tatsumaki = function(){
        $ken.addClass('tatsumaki');
        setTimeout(function() { $ken.addClass('down'); }, 1500);
        setTimeout(function() { $ken.removeClass('tatsumaki down'); }, 2000);
    };
    var hadoken = function(){
        $ken.addClass('hadoken');
        setTimeout(function() { $ken.removeClass('hadoken'); }, 500);
        setTimeout(function() {
            var $fireball = $('<div/>', { class:'fireball' });
            $fireball.appendTo($ken);

            var isFireballColision = function(){
                return $fireballPos.left + 75 > $(window).width() ? true : false;
            };

            var explodeIfColision = setInterval(function(){

                $fireballPos = $fireball.offset();
                //console.log('fireballInterval:',$fireballPos.left);

                if (isFireballColision()) {
                    $fireball.addClass('explode').removeClass('moving').css('marginLeft','+=22px');
                    clearInterval(explodeIfColision);
                    setTimeout(function() { $fireball.remove(); }, 500);
                }

            }, 50);

            setTimeout(function() { $fireball.addClass('moving'); }, 20);

            setTimeout(function() {
                $fireball.remove();
                clearInterval(explodeIfColision);
            }, 3020);

        }, (250));
    };
    var shoryuken = function(){
        $ken.addClass('shoryuken');
        setTimeout(function() { $ken.addClass('down'); }, 500);
        setTimeout(function() { $ken.removeClass('shoryuken down'); }, 1000);
    };
    var jump = function(){
        $ken.addClass('jump');
        setTimeout(function() { $ken.addClass('down'); }, 500);
        setTimeout(function() { $ken.removeClass('jump down'); }, 1000);
    };
    var kneel = function(){
        $ken.addClass('kneel');
    };
    var walkLeft = function(){
        $ken.addClass('walk').css({ marginLeft:'-=10px' });
    };
    var walkRight = function(){
        $ken.addClass('walk').css({ marginLeft:'+=10px' });
    };

    // on click events
    $('#a').click(punch);
    $('#z').click(kick);
    $('#e').click(rkick);
    $('#q').click(tatsumaki);
    $('#s').click(hadoken);
    $('#d').click(shoryuken);
    $('#up').click(jump);
    $('#down').on('mousedown mouseup', function(e){
        if (e.type == 'mousedown') { kneel(); }
        else { $ken.removeClass('kneel'); }
    });
    $('#left').on('mousedown mouseup', function(e){
        if (e.type == 'mousedown') { walkLeft(); }
        else { $ken.removeClass('walk'); }
    });
    $('#right').on('mousedown mouseup', function(e){
        if (e.type == 'mousedown') { walkRight(); }
        else { $ken.removeClass('walk'); }
    });

    // on keydown events
    $(document).on('keydown keyup', function(e) {
        if (e.type == 'keydown') {

            // s - hadoken
            if (e.keyCode == 83
                    && !$ken.hasClass('tatsumaki')
                    && !$ken.hasClass('shoryuken')
                    && !$ken.hasClass('hadoken')
                    && !$ken.hasClass('punch')
                    && !$ken.hasClass('kick')
                    && !$ken.hasClass('reversekick')
            ) {
                hadoken();
            }

            // d - shoryuken
            if (e.keyCode == 68
                    && !$ken.hasClass('tatsumaki')
                    && !$ken.hasClass('shoryuken')
                    && !$ken.hasClass('hadoken')
                    && !$ken.hasClass('punch')
                    && !$ken.hasClass('kick')
                    && !$ken.hasClass('reversekick')
                    && !$ken.hasClass('jump')
            ) {
                shoryuken();
            }

            // q - tatsumaki senpuu kyaku
            if (e.keyCode == 81
                    && !$ken.hasClass('tatsumaki')
                    && !$ken.hasClass('shoryuken')
                    && !$ken.hasClass('hadoken')
                    && !$ken.hasClass('punch')
                    && !$ken.hasClass('kick')
                    && !$ken.hasClass('reversekick')
                    && !$ken.hasClass('jump')
            ) {
                tatsumaki();
            }

            // a - punch
            if (e.keyCode == 65
                    && !$ken.hasClass('punch')
                    && !$ken.hasClass('hadoken')
                    && !$ken.hasClass('shoryuken')
                    && !$ken.hasClass('tatsumaki')
            ) {
                punch();
            }

            // e - kick
            if (e.keyCode == 90
                    && !$ken.hasClass('kick')
                    && !$ken.hasClass('hadoken')
                    && !$ken.hasClass('shoryuken')
                    && !$ken.hasClass('tatsumaki')
            ) {
                kick();
            }

            // r - reverse kick
            if (e.keyCode == 69
                    && !$ken.hasClass('reversekick')
                    && !$ken.hasClass('kick')
                    && !$ken.hasClass('hadoken')
                    && !$ken.hasClass('shoryuken')
                    && !$ken.hasClass('tatsumaki')
            ) {
                rkick();
            }

            // up - jump
            if (e.keyCode == 38
                    && !$ken.hasClass('jump')
                    && !$ken.hasClass('reversekick')
                    && !$ken.hasClass('kick')
                    && !$ken.hasClass('hadoken')
                    && !$ken.hasClass('shoryuken')
                    && !$ken.hasClass('tatsumaki')
            ) {
                jump();
            }

            // down - kneel
            if (e.keyCode == 40
                    && !$ken.hasClass('kneel')
                    && !$ken.hasClass('jump')
                    && !$ken.hasClass('reversekick')
                    && !$ken.hasClass('kick')
                    && !$ken.hasClass('hadoken')
                    && !$ken.hasClass('shoryuken')
                    && !$ken.hasClass('tatsumaki')
            ) {
                kneel();
            }


            // ← flip
            //if (e.keyCode == 37) $ken.addClass('flip');
            // → unflip
            //if (e.keyCode == 39) $ken.removeClass('flip');
            // ←← →→ walking
            if (e.keyCode == 37) { walkLeft(); }
            if (e.keyCode == 39) { walkRight(); }
        }
        else { // keyup
            $ken.removeClass('walk kneel');
        }
        return false;
        //console.log(e.keyCode);
    });

</script>
</html>