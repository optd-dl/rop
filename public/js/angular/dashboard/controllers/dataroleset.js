"use strict";define([],function(){return["$rootScope","$scope","$q","$http","$mdDialog",function($rootScope,$scope,$q,$http,$mdDialog){function getKeyList(){return $scope.refreshing=!0,initUserQ.then(function(){if($scope.tableUserList._select&&$scope.tableUserList._select.user_id)return $rootScope.ajax("key_list",{isv_user_id:$scope.tableUserList._select.user_id}).then(function(data){$scope.tableKeyData=data.key_list,$scope.tableUserList._select.param_count=data.key_list.length+"";for(var i=0,length=$scope.userData.length;i<length;i++)if($scope.userData[i].user_id===$scope.tableUserList._select.user_id){$scope.userData[i].param_count=data.key_list.length+"";break}return data})})["finally"](function(){$scope.refreshing=!1})}function initUser(){return $scope.loading=!0,$rootScope.ajax("user_list").then(function(data){return $scope.userData=data.user_list,$scope.tableUserList=data.user_list,$scope.tableUserList.length>0&&($scope.tableUserList._select=$scope.tableUserList[0]),data})["finally"](function(){$scope.loading=!1})}$rootScope.tab="dataroleset",$scope.columns=[{text:"开发者编码",name:"user_id"},{text:"开发者名称",name:"user_name"},{text:"配置数量",name:"param_count",style:{width:"128px"}}];var initUserQ=void 0,getKeyQ=void 0;$scope.reset=function(){$scope.userData=[],$scope.tableUserList=[],$scope.tableKeyData=[],$scope.loading=!0,$scope.keyword="",$scope.tableUserList._select=void 0,initUserQ=initUser(),getKeyQ=getKeyList()},$scope.reset(),$scope.research=function(){return initUserQ.then(function(){var _select=$scope.tableUserList._select;return $scope.tableUserList=[].concat.apply([],$scope.userData.map(function(r){return r.user_name.indexOf($scope.keyword)!=-1?[r]:[]})),$scope.tableUserList._select=_select,$scope.tableUserList})},$scope.selectUser=function(user){$scope.tableUserList._select=user,getKeyQ=getKeyList()},$scope.keySave=function(){$scope.refreshing=!0,$rootScope.ajax("role_save",{isv_user_id:$scope.tableUserList._select&&$scope.tableUserList._select.user_id,key_list:$scope.tableKeyData.length>0?$scope.tableKeyData:void 0}).then(function(){getKeyQ=getKeyList()},function(){$scope.refreshing=!1})},$scope.append=function(selector){$scope.tableKeyData.push({key_name:"",key_value:""});var $el=angular.element(selector);$el.animate({scrollTop:$el[0].scrollHeight})},$scope.splice=function(index){$scope.tableKeyData.splice(index,1)},$scope.injectorLoaded=!0,window.test=$scope}]});