"use strict";define(["require","angular"],function(require,angular){var _this=this,controllerModule=angular.module("supplier.controllers",[]);controllerModule.controller("IndexCtrl",["$scope","$injector",function($scope,$injector){$scope.injectorLoaded=!1,require(["supplier/controllers/index"],function(IndexController){$injector.invoke(IndexController,_this,{$scope:$scope}),$scope.$digest()})}]).controller("FunctionCtrl",["$rootScope","$scope","$http",function($rootScope,$scope,$http){$rootScope.tab="function",$('a[href^="#"]',"#partials").click(function(e){e.preventDefault()});var featureQ=$http.post("/agent",{module:"supplier",partial:"function",api:"get_feature",param:{ssv_user_id:$rootScope.ssv_user_id}}).then(function(body){body&&body.data&&body.data.user_desc&&($scope.ssv_feature=body.data.user_desc)},function(why){$rootScope.alert(why)});$scope.$on("$viewContentLoaded",function(event){featureQ["finally"](function(){$scope.injectorLoaded=!0,$rootScope.removeLoading()})})}]).controller("AllCommentCtrl",["$rootScope","$scope","$http",function($rootScope,$scope,$http){$rootScope.tab="allComment",$('a[href^="#"]',"#partials").click(function(e){e.preventDefault()}),$scope.comments=[],$scope.searcher=function(){return $scope.loading=!0,$http.post("/agent",{module:"supplier",partial:"all-comment",api:"comments",param:{ssv_user_id:$rootScope.ssv_user_id}}).then(function(body){"number"==typeof body.data.page_count?body.data.page_count:new Number(body.data.page_count);body.data.data_list&&body.data.data_list.length&&$.extend($scope.comments,body.data.data_list),$scope.loading=!1},function(why){$scope.loading=!1,$rootScope.alert(why)})},$scope.saveComment=function(){return $scope.commentForm.$invalid?($scope.commentForm.$error.required&&$scope.commentForm.$error.required.forEach(function(r){r.$setDirty(!0)}),$("#flash").addClass("warn"),void setTimeout(function(){$("#flash").removeClass("warn"),$scope.$apply()},1e3)):$rootScope.profile?void $http.post("/agent",{module:"supplier",partial:"all-comment",api:"add",param:{comment_content:$scope.comment_content_area,ssv_user_id:$scope.ssv_user_id}}).then(function(body){"boolean"==typeof body.data.is_success&&body.data.is_success||"string"==typeof body.data.is_success&&"true"==body.data.is_success?($scope.commentForm.$setPristine(),$scope.comment_content_area="",$scope.searcher()):$rootScope.alert(body.data.msg)},function(why){$rootScope.alert(why)}):void $rootScope.showAdvanced()},$scope.isCurrentSsv=function(){return!(!$rootScope.profile||!$rootScope.ssv_intro)&&$rootScope.profile.login_user_name==$rootScope.ssv_intro.user_name},$scope.toggleReply=function(comment){comment._toggleReply=!comment._toggleReply},$scope.replyComment=function(comment){comment._toggleReply=!comment._toggleReply,setTimeout(function(){$http.post("/agent",{module:"supplier",partial:"all-comment",api:"reply",param:{comment_id:comment.comment_id,comment_content:comment._comment_content,ssv_user_id:$scope.ssv_user_id}}).then(function(body){"boolean"==typeof body.data.is_success&&body.data.is_success||"string"==typeof body.data.is_success&&"true"==body.data.is_success?(delete comment._comment_content,$scope.searcher()):$rootScope.alert(body.data.msg)},function(why){$rootScope.alert(why)})},400)},$scope.isCreator=function(comment){return!(!$rootScope.profile||!comment)&&$rootScope.profile.login_user_name==comment.create_user},$scope.deleteComment=function(comment,comments){$http.post("/agent",{module:"supplier",partial:"all-comment",api:"delete",param:{comment_id:comment.comment_id}}).then(function(body){"boolean"==typeof body.data.is_success&&body.data.is_success||"string"==typeof body.data.is_success&&"true"==body.data.is_success?($scope.comment_content_area="",comments.splice(comments.indexOf(comment),1)):$rootScope.alert(body.data.msg)},function(why){$rootScope.alert(why)})},$scope.checkID=function(){return!!$rootScope.profile&&($rootScope.profile.id==$scope.ssv_user_id,!0)},$scope.$on("$viewContentLoaded",function(event){$scope.searcher()["finally"](function(){$scope.injectorLoaded=!0,$rootScope.removeLoading()})})}]).controller("APICtrl",["$scope","$injector",function($scope,$injector){$scope.injectorLoaded=!1,require(["supplier/controllers/api"],function(APIController){$injector.invoke(APIController,_this,{$scope:$scope}),$scope.$digest()})}]).controller("InfoCtrl",["$rootScope","$scope","$http",function($rootScope,$scope,$http){$rootScope.tab="info",$('a[href^="#"]',"#partials").click(function(e){e.preventDefault()}),$scope.infos=[];var pageIndex=1,pageSize=6;$scope.searcher=function(){return $scope.loading=!0,$http.post("/agent",{module:"supplier",partial:"info",api:"infos",param:{pageindex:pageIndex,pagesize:pageSize,ssv_user_id:$rootScope.ssv_user_id}}).then(function(body){var totalPages="number"==typeof body.data.page_count?body.data.page_count:new Number(body.data.page_count);totalPages>=pageIndex&&body.data.data_list&&body.data.data_list.length?(body.data.data_list.forEach(function(r,i){$scope.infos.push(r)}),pageIndex++):$scope.loaded=!0,$scope.loading=!1},function(why){$scope.loading=!1,$rootScope.alert(why)})},window.test=$scope,$scope.$on("$viewContentLoaded",function(event){$scope.searcher()["finally"](function(){$scope.injectorLoaded=!0,$rootScope.removeLoading()})})}])});