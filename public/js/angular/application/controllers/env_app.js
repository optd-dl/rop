"use strict";define(["../../services"],function(cta){return["$rootScope","$scope","$q","$location","$mdDialog",function($rootScope,$scope,$q,$location,$mdDialog){$rootScope.tab="env_app";$rootScope.ajax("init",{}).then(function(data){$scope.preset=data,$scope.searcher=function(index,size){return $scope.refreshing=!0,$rootScope.ajax("list",{user_id:$scope.selectedUser?$scope.selectedUser.user_id:"",eid:$scope.selectedEnv?$scope.selectedEnv.eid:"",pageindex:void 0!==index?index:$scope.pageIndex,pagesize:void 0!==size?size:$scope.pageSize}).then(function(data){"boolean"==typeof data.is_success&&data.is_success||"string"==typeof data.is_success&&"true"==data.is_success?($scope.tableData=data.data_list,$scope.total=data.list_count):($rootScope.alert(data.msg),$scope.total=0)})["finally"](function(){$scope.refreshing=!1})},$scope.reset(),$scope.multi=$scope.preset&&"1"==$scope.preset.uat_flag});$scope.research=function(){$scope.pageIndex=1,$scope.pageSize=new Number(10)},$scope.reset=function(){$scope.pageIndex=1,$scope.pageSize=new Number(10),$scope.selectedUser=null,$scope.selectedEnv=null},$scope.confirm=function(e){e.preventDefault(),e.stopPropagation(),$scope.refreshing||($scope.multi?$rootScope.confirm("停用多环境，将会使所有开发者应用的调用环境全部停用，是否停用多环境？",function(){$scope.refreshing=!0,$rootScope.ajax("status",{status:"0"}).then(function(data){return $scope.pageIndex=1,$scope.searcher()})["finally"](function(){$scope.multi=!1,$scope.refreshing=!1})}):$rootScope.confirm("开启多环境，多环境功能将在10分钟后生效，是否开启多环境？",function(){$scope.refreshing=!0,$rootScope.ajax("status",{status:"1"}).then(function(data){return $scope.pageIndex=1,$scope.searcher()})["finally"](function(){$scope.multi=!0,$scope.refreshing=!1})}))},$scope.confirm=function(e){e.preventDefault(),e.stopPropagation(),$scope.refreshing||($scope.multi?$rootScope.confirm("停用多环境，将会使所有开发者应用的调用环境全部停用，是否停用多环境？",function(){$scope.refreshing=!0,$rootScope.ajax("status",{status:"0"}).then(function(data){return $scope.pageIndex=1,$scope.searcher()})["finally"](function(){$scope.multi=!1,$scope.refreshing=!1})}):$rootScope.confirm("开启多环境，多环境功能将在10分钟后生效，是否开启多环境？",function(){$scope.refreshing=!0,$rootScope.ajax("status",{status:"1"}).then(function(data){return $scope.pageIndex=1,$scope.searcher()})["finally"](function(){$scope.multi=!0,$scope.refreshing=!1})}))},$scope.getTargetEnvironment=function(id){return $scope.preset&&$scope.preset.environment_list?[].concat.apply([],$scope.preset.environment_list.map(function(r){return r.eid==id?[r]:[]}))[0]:void 0},$scope.getTargetUser=function(id){return $scope.preset&&$scope.preset.user_list?[].concat.apply([],$scope.preset.user_list.map(function(r){return r.user_id==id?[r]:[]}))[0]:void 0},$scope.selectEnv=function(env){$scope.selectedEnv=env,$scope.research()},$scope.selectRowEnv=function(env,row){row.eid=env.eid},$scope.selectUser=function(user){$scope.selectedUser=user,$scope.research()},$scope.saveRowEnv=function(row){$rootScope.confirm("修改后的结果将在10分钟后生效。确定要保存吗？",function(){return $scope.refreshing=!0,$rootScope.ajax("save",{id:row&&row.id||"",eid:row&&row.eid||""}).then(function(){return $scope.searcher()})["finally"](function(){$scope.refreshing=!1})})},$scope.injectorLoaded=!0,window.test=function(){return $scope}}]});