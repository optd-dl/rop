!function(){function e(e){this.threads=Math.max(2,0|e),this._queue=[],this._queueSize=0,this._activeThreads=0,this._debug={start:0,end:0,time:0}}var t=window.URL||window.webkitURL;if(!t)throw new Error("This browser does not support Blob URLs");if(!window.Worker)throw new Error("This browser does not support Web Workers");e.prototype._worker={JSON:function(){var e=func;self.addEventListener("message",function(t){for(var r=t.data,n=new DataView(r),a=r.byteLength,i=Array(a),o=0;o<a;o++)i[o]=String.fromCharCode(n.getUint8(o));var s=JSON.parse(i.join("")),u=e.apply(e,s);try{r=JSON.stringify(u)}catch(t){throw new Error("Parallel function must return JSON serializable response")}a="undefined"==typeof r?0:r.length;var f=new ArrayBuffer(a);for(n=new DataView(f),o=0;o<a;o++)n.setUint8(o,255&r.charCodeAt(o));self.postMessage(f,[f]),self.close()})},Int32:function(){var e=func;self.addEventListener("message",function(t){for(var r=t.data,n=new DataView(r),a=r.byteLength/4,i=Array(a),o=0;o<a;o++)i[o]=n.getInt32(4*o);var s=e.apply(e,i);s instanceof Array||(s=[s]),a=s.length;var u=new ArrayBuffer(4*a);for(n=new DataView(u),o=0;o<a;o++)n.setInt32(4*o,s[o]);self.postMessage(u,[u]),self.close()})},Float64:function(){var e=func;self.addEventListener("message",function(t){for(var r=t.data,n=new DataView(r),a=r.byteLength/8,i=Array(a),o=0;o<a;o++)i[o]=n.getFloat64(8*o);var s=e.apply(e,i);s instanceof Array||(s=[s]),a=s.length;var u=new ArrayBuffer(8*a);for(n=new DataView(u),o=0;o<a;o++)n.setFloat64(8*o,s[o]);self.postMessage(u,[u]),self.close()})}},e.prototype._encode={JSON:function(e){try{var t=JSON.stringify(e)}catch(r){throw new Error("Arguments provided to parallel function must be JSON serializable")}len=t.length;for(var n=new ArrayBuffer(len),a=new DataView(n),i=0;i<len;i++)a.setUint8(i,255&t.charCodeAt(i));return n},Int32:function(e){len=e.length;for(var t=new ArrayBuffer(4*len),r=new DataView(t),n=0;n<len;n++)r.setInt32(4*n,e[n]);return t},Float64:function(e){len=e.length;for(var t=new ArrayBuffer(8*len),r=new DataView(t),n=0;n<len;n++)r.setFloat64(8*n,e[n]);return t}},e.prototype._decode={JSON:function(e){for(var t=new DataView(e),r=e.byteLength,n=Array(r),a=0;a<r;a++)n[a]=String.fromCharCode(t.getUint8(a));return n.length?JSON.parse(n.join("")):void 0},Int32:function(e){for(var t=new DataView(e),r=e.byteLength/4,n=Array(r),a=0;a<r;a++)n[a]=t.getInt32(4*a);return n},Float64:function(e){for(var t=new DataView(e),r=e.byteLength/8,n=Array(r),a=0;a<r;a++)n[a]=t.getFloat64(8*a);return n}},e.prototype._execute=function(e,t,r,n){if(this._activeThreads||(this._debug.start=(new Date).valueOf()),this._activeThreads<this.threads){this._activeThreads++;var a=((new Date).valueOf(),new Worker(e)),i=this._encode[r](t),o=this._decode[r],s=this;if("JSON"===r)var u=function(e){n.call(s,o(e.data)),s.ready()};else var u=function(e){n.apply(s,o(e.data)),s.ready()};a.addEventListener("message",u),a.postMessage(i,[i])}else this._queueSize++,this._queue.push([e,t,r,n])},e.prototype.ready=function(){this._activeThreads--,this._queueSize?(this._execute.apply(this,this._queue.shift()),this._queueSize--):this._activeThreads||(this._debug.end=(new Date).valueOf(),this._debug.time=this._debug.end-this._debug.start)},e.prototype._prepare=function(e,r){e=e;var n=e.name,a=e.toString();if(!n)for(n="$"+(10*Math.random()|0);a.indexOf(n)!==-1;)n+=10*Math.random()|0;var i=this._worker[r].toString().replace(/^.*?[\n\r]+/gi,"").replace(/\}[\s]*$/,"").replace(/\/\*\*\/name\/\*\*\//gi,n).replace(/\/\*\*\/func\/\*\*\//gi,a),o=t.createObjectURL(new Blob([i],{type:"text/javascript"}));return o},e.prototype.process=function(e,t){var r=this._prepare(e,"JSON"),n=this;return function(){n._execute(r,[].slice.call(arguments),"JSON",t)}},e.prototype.processInt32=function(e,t){var r=this._prepare(e,"Int32"),n=this;return function(){n._execute(r,[].slice.call(arguments),"Int32",t)}},e.prototype.processFloat64=function(e,t){var r=this._prepare(e,"Float64"),n=this;return function(){n._execute(r,[].slice.call(arguments),"Float64",t)}},window.Multithread=e}();